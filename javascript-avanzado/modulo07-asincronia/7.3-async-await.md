

# 7.3 Async / Await

## âš¡ Â¿QuÃ© es async/await?

Es **una forma moderna de trabajar con Promesas** pero con sintaxis parecida al cÃ³digo sÃ­ncrono.
Es decir, hace que el cÃ³digo asÃ­ncrono se lea como si fuera paso a paso.

---

## âœ… Reglas bÃ¡sicas

* `async` se usa para declarar una funciÃ³n asÃ­ncrona
* Dentro de una funciÃ³n async, puedes usar `await`
* `await` se **detiene hasta que la promesa se resuelva**

---

## âœï¸ Ejemplo bÃ¡sico

```js
function promesaSimple() {
  return Promise.resolve("Resultado ok âœ…");
}

async function ejecutar() {
  const resultado = await promesaSimple();
  console.log(resultado);
}

ejecutar();
```

---

## ðŸ”§ Reemplazando `.then()` por async/await

Antes con promesas encadenadas:

```js
obtenerUsuario()
  .then(user => obtenerPedidos(user.id))
  .then(pedidos => console.log(pedidos))
  .catch(error => console.log(error));
```

Ahora mÃ¡s limpio:

```js
async function cargarDatos() {
  try {
    const user = await obtenerUsuario();
    const pedidos = await obtenerPedidos(user.id);
    console.log(pedidos);
  } catch (error) {
    console.log(error);
  }
}
```

---

## ðŸ§¯ Manejo de errores

Usamos `try/catch` para capturar errores con async/await.

```js
async function dividir(a, b) {
  try {
    if (b === 0) throw new Error("No se puede dividir por cero");
    return a / b;
  } catch (error) {
    console.log("Error:", error.message);
  }
}
```

---

## ðŸ”„ Ejecutar promesas en paralelo con await

Si no hay dependencia entre llamadas, mejor paralelas:

```js
async function cargarTodo() {
  const promesa1 = obtenerProductos();
  const promesa2 = obtenerUsuarios();

  const [productos, usuarios] = await Promise.all([promesa1, promesa2]);
}
```

---

# ðŸ›  Laboratorio

## ðŸŽ¯ Objetivos

* Usar async/await correctamente
* Convertir cÃ³digo con .then() a async/await
* Manejar errores con try/catch
* Usar Promise.all con await

---

### Ejercicio 1 â€” FunciÃ³n async bÃ¡sica

```js
async function saludo() {
  return "Hola desde async ðŸ‘‹";
}
saludo().then(console.log);
```

---

### Ejercicio 2 â€” Usar await

```js
function dameNumero() {
  return Promise.resolve(42);
}

async function mostrarNumero() {
  const n = await dameNumero();
  console.log(n);
}

mostrarNumero();
```

---

### Ejercicio 3 â€” try/catch obligatorio

```js
async function obtenerUsuario(id) {
  if (!id) throw new Error("ID requerido");
  return { id, nombre: "Ada" };
}

async function main() {
  try {
    const user = await obtenerUsuario(1);
    console.log(user);
  } catch (e) {
    console.log("Error:", e.message);
  }
}

main();
```

---

### Ejercicio 4 â€” Convertir .then() a async/await

Antes:

```js
fetchDatos().then(d => console.log(d));
```

Ahora:

```js
async function cargar() {
  const datos = await fetchDatos();
  console.log(datos);
}
```

---

### Ejercicio 5 â€” EjecuciÃ³n en paralelo

```js
async function cargarTodo() {
  const a = Promise.resolve("A");
  const b = Promise.resolve("B");
  const c = Promise.resolve("C");

  const resultados = await Promise.all([a, b, c]);
  console.log(resultados); // ["A", "B", "C"]
}
```

---

## ðŸš€ Retos

1. Crea `esperar(ms)` como promesa y Ãºsala con await.
2. Hace login con demora de 2 segundos y luego muestra "Bienvenido".
3. Consulta tres APIs falsas en paralelo usando Promise.all.

