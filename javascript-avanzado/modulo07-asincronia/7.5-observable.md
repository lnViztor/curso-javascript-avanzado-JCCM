## 7.4 Observables

âš¡ **Â¿QuÃ© es un Observable?**
Un **Observable** es una fuente de datos que **emite valores a lo largo del tiempo**.
Puedes **suscribirte** a Ã©l para reaccionar a esos valores (como si fuera un stream de eventos).

ğŸ‘‰ Son la base de la **programaciÃ³n reactiva** (usada en librerÃ­as como **RxJS** o frameworks como **Angular**).

---

### âœ… Conceptos clave

* Un **Observable** *emite* valores (next), puede *fallar* (error) o *completar* (complete).
* Un **Observer** es quien se *suscribe* para recibir esos valores.
* Un **Subscription** es el vÃ­nculo entre Observable y Observer; se puede cancelar con `.unsubscribe()`.

---

### âœï¸ Ejemplo bÃ¡sico

```js
import { Observable } from "rxjs";

const miObservable = new Observable(subscriber => {
  subscriber.next("Hola ğŸ‘‹");
  subscriber.next("Â¿CÃ³mo estÃ¡s?");
  subscriber.complete();
});

miObservable.subscribe({
  next: valor => console.log("Valor:", valor),
  complete: () => console.log("âœ… Completado")
});
```

ğŸ“¤ **Salida:**

```
Valor: Hola ğŸ‘‹
Valor: Â¿CÃ³mo estÃ¡s?
âœ… Completado
```

---

### ğŸ”„ Observables vs Promesas

| CaracterÃ­stica | Promise    | Observable              |
| -------------- | ---------- | ----------------------- |
| Emite un valor | âœ… SÃ­       | âš¡ MÃºltiples             |
| Cancelable     | âŒ No       | âœ… SÃ­                    |
| EjecuciÃ³n      | Inmediata  | Bajo demanda            |
| Encadenable    | SÃ­ (.then) | SÃ­ (pipes y operadores) |

---

### ğŸ”§ Creando observables comunes

```js
import { of, from } from "rxjs";

// Emite valores concretos
of(1, 2, 3).subscribe(console.log);

// Convierte un array a observable
from(["A", "B", "C"]).subscribe(console.log);
```

---

### â±ï¸ Observables con tiempo

```js
import { interval, take } from "rxjs";

interval(1000) // emite cada segundo
  .pipe(take(3)) // solo 3 emisiones
  .subscribe(v => console.log("â±ï¸", v));
```

ğŸ“¤ **Salida:**

```
â±ï¸ 0
â±ï¸ 1
â±ï¸ 2
```

---

### ğŸ§¯ Manejo de errores

```js
import { throwError, catchError, of } from "rxjs";

throwError(() => new Error("Error ğŸ˜±"))
  .pipe(catchError(err => of("Error capturado: " + err.message)))
  .subscribe(console.log);
```

---

### ğŸ§© Combinando y transformando observables

```js
import { of, map, filter } from "rxjs";

of(1, 2, 3, 4, 5)
  .pipe(
    filter(x => x % 2 === 0),
    map(x => x * 10)
  )
  .subscribe(console.log);
```

ğŸ“¤ **Salida:**

```
20
40
```

---

## ğŸ›  Laboratorio

### ğŸ¯ Objetivos

* Crear y suscribirse a observables.
* Usar operadores bÃ¡sicos (`map`, `filter`, `take`).
* Manejar errores con `catchError`.
* Controlar emisiones con `interval` y `unsubscribe`.

---

### ğŸ§ª Ejercicio 1 â€” Observable simple

```js
import { Observable } from "rxjs";

const saludo$ = new Observable(sub => {
  sub.next("Hola desde un Observable ğŸ‘‹");
  sub.complete();
});

saludo$.subscribe(console.log);
```

---

### ğŸ§ª Ejercicio 2 â€” Observable con intervalo

```js
import { interval, take } from "rxjs";

const contador$ = interval(1000).pipe(take(5));
contador$.subscribe(n => console.log("Tick:", n));
```

---

### ğŸ§ª Ejercicio 3 â€” Transformar valores

```js
import { of, map } from "rxjs";

of(10, 20, 30)
  .pipe(map(x => x / 10))
  .subscribe(console.log); // 1, 2, 3
```

---

### ğŸ§ª Ejercicio 4 â€” Manejar errores

```js
import { throwError, catchError, of } from "rxjs";

throwError(() => new Error("Algo saliÃ³ mal"))
  .pipe(catchError(e => of("Recuperado: " + e.message)))
  .subscribe(console.log);
```

---

### ğŸ§ª Ejercicio 5 â€” Cancelar suscripciÃ³n

```js
import { interval, takeUntil, timer } from "rxjs";

const source$ = interval(1000);
const stop$ = timer(5000); // detiene a los 5s

source$.pipe(takeUntil(stop$)).subscribe({
  next: v => console.log("Tick", v),
  complete: () => console.log("ğŸ›‘ Detenido")
});
```

---

## ğŸš€ Retos

1. Crea un observable que emita cada 500 ms y se detenga a los 3 s.
2. Usa `from(fetch(...))` para convertir una llamada `fetch` en observable.
3. Crea una secuencia que emita nombres y solo deje pasar los que tengan mÃ¡s de 4 letras.
4. Combina dos observables (`of` y `interval`) con `zip` o `combineLatest`.
5. Implementa un â€œsimulador de progresoâ€ que emita del 0% al 100% cada 200 ms.