# 7.4 Uso de la API fetch

## ðŸŒ Â¿QuÃ© es fetch?

`fetch()` es la forma moderna de hacer **peticiones HTTP** en JavaScript para obtener datos de un servidor o enviar informaciÃ³n.

Funciona con **promesas** y es nativo del navegador (tambiÃ©n estÃ¡ disponible en Node.js moderno).

---

## âœ… Sintaxis bÃ¡sica

```js
fetch(url)
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error("Error:", error));
```

---

## âœ¨ Con async/await (forma moderna recomendada)

```js
async function cargarDatos() {
  try {
    const respuesta = await fetch("https://jsonplaceholder.typicode.com/users");
    const datos = await respuesta.json();
    console.log(datos);
  } catch (error) {
    console.error("Algo saliÃ³ mal:", error);
  }
}
cargarDatos();
```

---

## ðŸ“¡ MÃ©todos HTTP con fetch

Por defecto, fetch usa **GET**, pero podemos enviar datos usando **POST**, **PUT**, **DELETE**, etc.

```js
fetch("https://api.example.com/users", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ nombre: "Ada", edad: 36 })
});
```

---

## â— Manejo de errores HTTP

fetch **no lanza error automÃ¡ticamente** si el servidor responde con 404 o 500.
Debemos comprobar manualmente `response.ok`.

```js
async function cargar() {
  const res = await fetch("https://api.example.com/404");
  if (!res.ok) throw new Error("Error HTTP: " + res.status);
}
```

---

## ðŸ§± Headers (cabeceras)

```js
fetch("https://api.example.com/test", {
  headers: {
    "Authorization": "Bearer token123",
    "Accept": "application/json"
  }
});
```

---

## ðŸ—ï¸ Enviar JSON con POST

```js
async function enviar() {
  const res = await fetch("https://jsonplaceholder.typicode.com/posts", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ titulo: "Hola", cuerpo: "Estoy probando fetch" })
  });
  const data = await res.json();
  console.log("Respuesta:", data);
}
enviar();
```

---

# ðŸ›  Laboratorio

## ðŸŽ¯ Objetivos

* Hacer peticiones GET y POST con fetch
* Leer respuestas de servidores
* Manejar errores HTTP
* Usar async/await con fetch

---

### Ejercicio 1 â€” GET simple

ObtÃ©n usuarios de una API pÃºblica.

```js
async function getUsuarios() {
  const res = await fetch("https://jsonplaceholder.typicode.com/users");
  const data = await res.json();
  console.log(data);
}
getUsuarios();
```

---

### Ejercicio 2 â€” Manejo de error HTTP

```js
async function traerDatos() {
  const res = await fetch("https://jsonplaceholder.typicode.com/404");
  if (!res.ok) {
    console.log("Error HTTP:", res.status);
    return;
  }
}
traerDatos();
```

---

### Ejercicio 3 â€” Enviar datos con POST

```js
async function crearPost() {
  const res = await fetch("https://jsonplaceholder.typicode.com/posts", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ title: "Nuevo", body: "Probando" })
  });
  console.log(await res.json());
}
crearPost();
```

---

### Ejercicio 4 â€” Fetch + DOM

Carga una lista de usuarios y muÃ©strala en la pÃ¡gina.

```js
async function mostrarUsuarios() {
  const res = await fetch("https://jsonplaceholder.typicode.com/users");
  const data = await res.json();

  const lista = document.getElementById("usuarios");
  data.forEach(u => {
    const li = document.createElement("li");
    li.textContent = u.name;
    lista.appendChild(li);
  });
}
```

---

### Ejercicio 5 â€” Fetch con try/catch

```js
async function traer() {
  try {
    const res = await fetch("https://jsonplaceholder.typicode.com/posts/1");
    const data = await res.json();
    console.log(data);
  } catch (error) {
    console.error("Error en fetch:", error);
  }
}
```

---

## ðŸš€ Retos

1. Haz un mini buscador de usuarios con fetch.
2. EnvÃ­a un formulario usando fetch en lugar de submit clÃ¡sico.
3. Captura y muestra errores de red con un mensaje visible al usuario.